---
title: "Cost of testing stategies in LAMP, qPCR, and isolations/quarantine beds"
author: "Will Rogers"
date: "12/2/2020"
output: pdf_document
---

```{r setup, include=FALSE}
library(tidyverse)
### Running files 
setwd("~/Downloads/Research/COVID-19/LAMP/COVID-Modeling")

# Always rerun these if you edit the source file
source("sir_lamp_function.R")
source("sir_simple_step_function.R")
source("uni_sim_function.R")
source("uni_sim_par_function.R")
source("plotting_functions.R")

# These are good to have on hand
library(data.table)
library(mc2d)
library(abind)
```

#### Costs of testing and isolation

LAMP tests cost around $3.50 per test  
qPCR tests cost around $10 per test
We assume that housing students in quarantine/isolation costs 50$ per day, though we report raw student days as well


### Testing Scenarios

LAMP testing may be costly to implement. So, does the use of LAMP justify the cost of implementation? Cost can come from a number of mechanisms - raw dollars, student days lost in a semester, overburden of health infrastructure, etc. Here we attempt to describe four scenarios of testing:
  1. No action beyond surveilance qPCR tests administered to symptomatic students
  2. An attainable 2000 LAMP tests per day, confirmatory qPCR tests of positive LAMP students, and surveilance qPCR tests administered to symptomatic students
  3. 2000 LAMP tests per day as diagnostic tests (pending FDA approval) and surveilance qPCR tests administered to symptomatic students
  4. And 2000 LAMP tests per day with pooling factors of 1:3 and surveilance qPCR tests administered to symptomatic students
  
We will record the number of students isolating and quarantining per day as well as the number of days in excess of forcasted supply, the number of qPCR tests administered to symptomatic students and confirmatory qPCR tests as well as the number of days in excess of forcasted supply, and the costs 

### Modeling assumptions

Please refer to prior documentation of LAMP modeling for intricate descriptions of outcomes. Here, we assume that the epidemic on campus with have some general characteristics the epidemic in the Fall semester and maintain similar epidemilogical trends. Instead of considering all parameter space available, we will consider best and worst case scenarios, described below. 

Best Case Scenario 
  - Immunity is high (0.15)
  - Introduced infections from students are low (0.0025)
  - Introduced infections from the community are high (1 every 10 days)
  - Student care-seeking (if symptomatic, seeking a qPCR test) is high (100%)
  - Student compliance (if test positive or contact, isolating) is high (100%)
  - R0, a measure of the epidemic's ability to grow, is low (2.5)
  - Students are notified of their test results in the same day
  - LAMP sensitivity is optimal (92.5%)
  - Contact tracing occurs (25 per day maximum)
  
Worst Case Scenario 
  - Immunity is low (0.05)
  - Introduced infections from students are high (0.05)
  - Introduced infections from the community are high (1 every 5 days)
  - Student care-seeking (if symptomatic, seeking a qPCR test) is low (50%)
  - Student compliance (if test positive or contact, isolating) is high (75%)
  - R0, a measure of the epidemic's ability to grow, is high (3)
  - Students are notified of their test results with a delay of 2 day
  - LAMP sensitivity is suboptimal (80%)
  - Contact tracing fails (0 per day maximum)

```{r}
set.seed(123)
best <- uni_sims_par(tst = c(0,2000),
                       test.timeline = c("Sustained","Both"),
                       compliance = c(.8),
                       init.prev = c(0.005),
                       ppn_sympt = c(0.35),
                       care.seeking = c(.5),
                       R0.on = c(2, 3),
                       R0.off = c(2, 3),
                       test.scenario = c("1 Day"),
                       sens.pcr = 1,
                       spec.pcr = 1,
                       sens.lamp = c(0.75, 0.9250),
                       spec.lamp = 1,
                       lamp.diagnostic = c(F),
                       community.intro.daily.on = 1,
                       community.prob.daily.on = c(0.1),
                       community.intro.daily.off = 1,
                       community.prob.daily.off = c(0.1),
                       immunity = c(0.1),
                       N0 = 16750,
                       on.campus.prop = .25,
                       contact.tracing.limit = c(25),
                       pooling = c(1,2),
                       pooling.multi = c(1),
                       days = 100,
                       sims = 100,
                       ncores=4)

best. <- best %>%
  group_by(group) %>%
  mutate(cum.cases.on = cumsum(new.cases.on),
         cum.reporting.symptoms.on = cumsum(reporting.symptoms.on),
         cum.all.symptomatics.on = cumsum(all.symptomatics.on),
         cum.all.asymptomatics.on = cumsum(positive.asympt.on),
         cum.cases.off = cumsum(new.cases.off),
         cum.reporting.symptoms.off = cumsum(reporting.symptoms.off),
         cum.all.symptomatics.off = cumsum(all.symptomatics.off),
         cum.all.asymptomatics.off = cumsum(positive.asympt.off),
         cum.sum.missed = cumsum(missed.pcr),
         cum.iso.on = cumsum(isolation.complying.on),
         cum.iso.off = cumsum(isolation.complying.off),
         cum.qua.on = cumsum(quarantine.complying.on),
         cum.qua.off = cumsum(quarantine.complying.off),
         pcr.demand.sym = cumsum(symp.pcr), 
         pcr.demand.asym = cumsum(asymp.pcr)
  )
```

```{r}
best. %>%
  filter(R0.on == 3,
         pooling == 1,
         sens.lamp == .925) %>%
  ggplot(aes(x = day, y = cum.iso.on+cum.iso.off)) +
  geom_smooth()
```



#### Costs in best scenario
```{r}
best.cummulative <- best. %>% 
  filter(day == max(day)) %>% 
  group_by(tests, test.timeline, pooling, R0.on, sens.lamp) %>% 
  summarize(mean.cases = sum(cum.cases.on+cum.cases.off),
            sd.cases = sd(cum.cases.on+cum.cases.off),
            mean.iso = sum(cum.iso.on+cum.iso.off),
            sd.iso = sd(cum.iso.on+cum.iso.off),
            mean.quarantine = sum(cum.qua.on+cum.qua.off),
            sd.quarantine = sd(cum.qua.on+cum.qua.off),
            mean.pcr.sym = mean(pcr.demand.sym),
            sd.pcr.sym = sd(pcr.demand.sym),
            mean.pcr.asym = mean(pcr.demand.asym),
            sd.pcr.asym = sd(pcr.demand.asym)
            )

df <- best.cummulative[c(1,3,17:32),]
write.csv(df, "SimulationsForPrice.csv")
df$mean.iso[which(df$tests==0)][1]+df$mean.quarantine[which(df$tests==0)][1]
```

If we test only symptomatic students, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==0)][1]` and `r df$mean.cases[which(df$tests==0)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==0)][1]` and `r df$mean.pcr.sym[which(df$tests==0)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==0)][1]*10` and `r df$mean.pcr.sym[which(df$tests==0)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==0)][1]+df$mean.quarantine[which(df$tests==0)][1]` and `r df$mean.iso[which(df$tests==0)][2]+df$mean.quarantine[which(df$tests==0)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==0)][1]+df$mean.quarantine[which(df$tests==0)][1])*50` and `r (df$mean.iso[which(df$tests==0)][2]+df$mean.quarantine[which(df$tests==0)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we test 2000 random students per day with poor LAMP sensitivity (80%) and an equal distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we test 2000 random students per day with good LAMP sensitivity (92.5%) and an equal distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we test 2000 random students per day with poor LAMP sensitivity (80%) and a front-loaded distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we test 2000 random students per day with good LAMP sensitivity (92.5%) and a front-loaded distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we test 2000 random students per day with poor LAMP sensitivity (80%) and a front-loaded distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .8)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we test 2000 random students per day with good LAMP sensitivity (92.5%) and a front-loaded distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==1 & df$test.timeline == "Both" & df$sens.lamp == .925)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we increase pooling to a factor of 2 (assuming that pooling will decrease sensitivity by a factor of 2), we can increase the distribution of tests to students. 

If we test 2000 random students per day with poor LAMP sensitivity (80%), with a pool of 2, and an equal distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .8)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we test 2000 random students per day with good LAMP sensitivity (92.5%), with a pool of 2, and an equal distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Sustained" & df$sens.lamp == .925)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we test 2000 random students per day with poor LAMP sensitivity (80%), with a pool of 2, and a front-loaded distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we test 2000 random students per day with good LAMP sensitivity (92.5%), with a pool of 2, and a front-loaded distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we test 2000 random students per day with poor LAMP sensitivity (80%), with a pool of 2, and a front-loaded distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .8)][2])*50` dollars if each isolation day costs 50 dollars to house students. 

If we test 2000 random students per day with good LAMP sensitivity (92.5%), with a pool of 2, and a front-loaded distribution of tests across the semester, we can expect an epidemic with a size between `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.cases[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]`. As a result, we can expect between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]` qPCR tests will be demanded by students, equating to between `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]*10` and `r df$mean.pcr.sym[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]*10` dollars. The resulting epidemic will cost between `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]` and `r df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]` student-days lost to forced isolation and quarantine measures, with an attendant cost of potentially between `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][1])*50` and `r (df$mean.iso[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2]+df$mean.quarantine[which(df$tests==2000 & df$pooling==2 & df$test.timeline == "Both" & df$sens.lamp == .925)][2])*50` dollars if each isolation day costs 50 dollars to house students.


